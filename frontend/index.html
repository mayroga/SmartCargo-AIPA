from fastapi import FastAPI
from fastapi.responses import FileResponse
from fastapi.staticfiles import StaticFiles
from pathlib import Path

app = FastAPI(title="SmartCargo-AIPA · Asesor documental")

# Carpeta estática con JS/CSS y index.html
app.mount("/static", StaticFiles(directory="static"), name="static")

# Ruta principal que sirve el index.html
@app.get("/")
async def serve_index():
    return FileResponse(Path("static/index.html"))

# -------------------
# Endpoints de cargo
# -------------------
from rules import validate_cargo

@app.post("/cargo/validate")
async def cargo_validate(mawb: str, hawb: str, origin: str, destination: str, cargo_type: str, flight_date: str, weight: float, volume: float):
    cargo_data = {
        "mawb": mawb,
        "hawb": hawb,
        "origin": origin,
        "destination": destination,
        "cargo_type": cargo_type,
        "flight_date": flight_date,
        "weight": weight,
        "volume": volume
    }
    result = validate_cargo(cargo_data)
    return result

@app.get("/cargo/list_all")
async def list_cargos():
    return []  # reemplaza con tus cargos reales

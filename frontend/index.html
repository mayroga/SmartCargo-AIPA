<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SmartCargo-AIPA</title>
<link rel="stylesheet" href="/static/style.css">
<style>
  body { font-family: Arial, sans-serif; background: #121212; color: #f0f0f0; margin: 0; padding: 0; }
  header { background: #1f1f1f; padding: 1rem; text-align: center; font-size: 1.5rem; font-weight: bold; }
  .container { padding: 1rem; max-width: 1200px; margin: auto; }
  .block { border: 1px solid #444; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; }
  .block h2 { margin-top: 0; }
  label { display: block; margin: 0.5rem 0 0.2rem 0; }
  select, input[type=text], textarea { width: 100%; padding: 0.5rem; border-radius: 5px; border: 1px solid #555; background: #222; color: #fff; }
  button { padding: 0.7rem 1.5rem; border: none; border-radius: 5px; cursor: pointer; margin-right: 0.5rem; font-weight: bold; }
  button.validate { background: #28a745; color: #fff; }
  button.clear { background: #ffc107; color: #000; }
  button.pdf { background: #007bff; color: #fff; }
  .result { margin-top: 1rem; padding: 1rem; border-radius: 8px; }
  .GREEN { background: #28a745; color: #fff; }
  .YELLOW { background: #ffc107; color: #000; }
  .RED { background: #dc3545; color: #fff; }
  .hidden { display: none; }
  footer { font-size: 0.8rem; color: #aaa; padding: 1rem; text-align: center; }
</style>
</head>
<body>

<header>SmartCargo-AIPA by May Roga LLC</header>

<div class="container">
  <form id="cargoForm">
    
    <!-- BLOQUE GENERAL -->
    <div class="block">
      <h2>Informaci칩n General</h2>
      <label for="role">Rol de Usuario:</label>
      <select id="role" name="role">
        <option value="Operator">Operador</option>
        <option value="Supervisor">Supervisor</option>
        <option value="Admin">Administrador</option>
      </select>

      <label for="lang">Idioma:</label>
      <select id="lang" name="lang">
        <option value="English">English</option>
        <option value="Spanish">Espa침ol</option>
      </select>

      <label for="cargoType">Tipo de Carga:</label>
      <select id="cargoType" name="cargoType">
        <option value="">--Seleccione--</option>
        <option value="Perishable">Perecederos</option>
        <option value="DG">Carga Peligrosa (DG)</option>
        <option value="Mixed">Mixta</option>
      </select>
    </div>

    <!-- BLOQUE LEGAL -->
    <div class="block" id="blockLegal">
      <h2>Legal</h2>
      <label for="sli">SLI / Factura Completa:</label>
      <select id="sli" name="sli">
        <option value="">--Seleccione--</option>
        <option value="Yes">S칤</option>
        <option value="No">No</option>
      </select>

      <label for="embargo">Embargo / Restricci칩n:</label>
      <select id="embargo" name="embargo">
        <option value="">--Seleccione--</option>
        <option value="None">Ninguno</option>
        <option value="Restricted">Restringido</option>
      </select>
    </div>

    <!-- BLOQUE SEGURIDAD -->
    <div class="block" id="blockSecurity">
      <h2>Seguridad</h2>
      <label for="knownShipper">Known Shipper:</label>
      <select id="knownShipper" name="knownShipper">
        <option value="">--Seleccione--</option>
        <option value="Yes">S칤</option>
        <option value="No">No</option>
      </select>
    </div>

    <!-- BLOQUE F칈SICO -->
    <div class="block" id="blockPhysical">
      <h2>F칤sico / Embalaje</h2>
      <label for="material">Material del embalaje:</label>
      <select id="material" name="material">
        <option value="">--Seleccione--</option>
        <option value="Wood">Madera</option>
        <option value="Plastic">Pl치stico</option>
      </select>

      <label for="height">Altura de la carga (cm):</label>
      <input type="text" id="height" name="height">

      <label for="weightDiff">Diferencia Peso B치scula vs Gu칤a (%):</label>
      <input type="text" id="weightDiff" name="weightDiff">

      <div id="perishableBlock" class="hidden">
        <label for="tempRange">Rango de temperatura (춿C):</label>
        <input type="text" id="tempRange" name="tempRange">

        <label for="iceType">Tipo de hielo:</label>
        <select id="iceType" name="iceType">
          <option value="">--Seleccione--</option>
          <option value="DryIce">Hielo Seco</option>
          <option value="Regular">Hielo Regular</option>
        </select>
      </div>

      <div id="dgBlock" class="hidden">
        <label for="dgd">DGD firmada:</label>
        <select id="dgd" name="dgd">
          <option value="">--Seleccione--</option>
          <option value="Yes">S칤</option>
          <option value="No">No</option>
        </select>

        <label for="unNumber">UN Number:</label>
        <input type="text" id="unNumber" name="unNumber">
      </div>
    </div>

    <!-- BOTONES -->
    <div class="block">
      <button type="button" class="validate" onclick="validateCargo()">Validar</button>
      <button type="button" class="clear" onclick="clearForm()">Limpiar</button>
      <button type="button" class="pdf" onclick="generatePDF()">Generar PDF</button>
    </div>
  </form>

  <!-- RESULTADO -->
  <div id="result" class="result hidden"></div>

  <!-- AVISO LEGAL -->
  <footer>
    游댮 Aviso Legal: SmartCargo-AIPA by May Roga LLC. La asesor칤a no sustituye decisiones de TSA, CBP, DOT o aerol칤neas.
  </footer>
</div>

<script>
const cargoTypeSelect = document.getElementById("cargoType");
const perishableBlock = document.getElementById("perishableBlock");
const dgBlock = document.getElementById("dgBlock");

cargoTypeSelect.addEventListener("change", () => {
    const type = cargoTypeSelect.value;
    perishableBlock.classList.add("hidden");
    dgBlock.classList.add("hidden");
    if (type === "Perishable") perishableBlock.classList.remove("hidden");
    if (type === "DG") dgBlock.classList.remove("hidden");
    if (type === "Mixed") {
        perishableBlock.classList.remove("hidden");
        dgBlock.classList.remove("hidden");
    }
});

function validateCargo() {
    const form = document.getElementById("cargoForm");
    const formData = new FormData(form);
    const data = {};
    formData.forEach((v,k) => data[k] = v);

    fetch("/validate", {
        method: "POST",
        body: new URLSearchParams(data)
    })
    .then(res => res.json())
    .then(resp => {
        const resultDiv = document.getElementById("result");
        resultDiv.className = "result " + resp.status;
        resultDiv.innerHTML = `<h3>Sem치foro: ${resp.status}</h3><pre>${resp.analysis}</pre><p>${resp.disclaimer}</p>`;
        resultDiv.classList.remove("hidden");
    })
    .catch(err => alert("Error al validar: " + err));
}

function clearForm() {
    document.getElementById("cargoForm").reset();
    document.getElementById("result").classList.add("hidden");
}

function generatePDF() {
    alert("Funci칩n PDF simulada. Los datos actuales se mostrar칤an en PDF en producci칩n.");
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SMARTCARGO-AIPA</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: #f2f4f7;
  margin: 0;
  padding: 0;
}

.container {
  max-width: 1200px;
  margin: 30px auto;
  background: #ffffff;
  padding: 30px 40px;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
}

h1 {
  margin-top: 0;
  color: #002b5c;
}

.subtitle {
  color: #555;
  margin-bottom: 30px;
}

.level {
  margin-bottom: 25px;
  border: 1px solid #ddd;
  border-radius: 10px;
  overflow: hidden;
}

.level-header {
  background: #004080;
  color: white;
  padding: 14px 18px;
  font-size: 17px;
  cursor: pointer;
}

.level-content {
  display: none;
  padding: 20px;
  background: #fafafa;
}

.question {
  margin-bottom: 22px;
}

.question-title {
  font-weight: 600;
  margin-bottom: 10px;
  color: #222;
}

.options label {
  display: block;
  margin-bottom: 6px;
  cursor: pointer;
}

.options input {
  margin-right: 8px;
}

.actions {
  text-align: center;
  margin-top: 35px;
}

button {
  background: #004080;
  color: white;
  border: none;
  padding: 14px 26px;
  font-size: 16px;
  border-radius: 8px;
  cursor: pointer;
  margin: 8px;
}

button:hover {
  background: #0066cc;
}

#result {
  margin-top: 35px;
  padding: 25px;
  border-radius: 12px;
  display: none;
}

.green { color: #0a8f08; }
.yellow { color: #d4a000; }
.red { color: #c00000; }
</style>
</head>

<body>

<div class="container">
<h1>SMARTCARGO-AIPA</h1>
<p class="subtitle">
Preventive Cargo Acceptance Advisory System<br>
Operational Â· Legal Â· Non-binding
</p>

<div id="levels"></div>

<div class="actions">
  <button onclick="submitForm()">Validate Cargo</button>
  <button onclick="location.reload()">Clear</button>
</div>

<div id="result">
  <h2 id="semaphore"></h2>
  <div id="recommendations"></div>
</div>

</div>

<script>
const levels = [
  { title:"Level 1 â€“ Identification & Transport", q:[
    "Type of cargo","Delivered by","Ground transport type","Cargo condition at receipt",
    "Pallet height compliant","Pallet length compliant","Truck seal present","Truck cleanliness"
  ]},
  { title:"Level 2 â€“ Documentation", q:[
    "Original AWB present","AWB copies available","Document readability",
    "Shipper name consistent","AWB matches physical cargo",
    "Invoices & packing list organized","Master / House AWB aligned","Origin / sanitary seals"
  ]},
  { title:"Level 3 â€“ Pallets & Packaging", q:[
    "Pallet type compliant","Pallet wrapping adequate","Height compliance",
    "Labels visible","Cargo segregated","Pallet stability","No visible damage","No overhang"
  ]},
  { title:"Level 4 â€“ Special Cargo Handling", q:[
    "Temperature control required","Temperature devices present","Dry ice declared",
    "DG declaration required","DG labels present","Human remains documentation",
    "Security screening completed","Escort required"
  ]},
  { title:"Level 5 â€“ Final Compliance", q:[
    "Weight correctly declared","Dimensions correctly declared","No prohibited items",
    "No leaks detected","Stacking allowed","ULD compatible",
    "Acceptance checklist complete","Supervisor approval","Final compliance confirmed"
  ]}
];

let qId = 1;
const container = document.getElementById("levels");

levels.forEach(lvl=>{
  const levelDiv = document.createElement("div");
  levelDiv.className = "level";

  const header = document.createElement("div");
  header.className = "level-header";
  header.textContent = lvl.title;
  header.onclick = ()=> {
    content.style.display = content.style.display==="block"?"none":"block";
  };

  const content = document.createElement("div");
  content.className = "level-content";

  lvl.q.forEach(q=>{
    const d = document.createElement("div");
    d.className="question";
    d.innerHTML = `
      <div class="question-title">${qId}. ${q}</div>
      <div class="options">
        <label><input type="radio" name="q${qId}" value="ok"> Compliant</label>
        <label><input type="radio" name="q${qId}" value="warn"> Requires Review</label>
        <label><input type="radio" name="q${qId}" value="fail"> Not Compliant</label>
      </div>`;
    content.appendChild(d);
    qId++;
  });

  levelDiv.appendChild(header);
  levelDiv.appendChild(content);
  container.appendChild(levelDiv);
});

function submitForm(){
  const answers = {};
  document.querySelectorAll("input[type=radio]:checked").forEach(r=>{
    answers[r.name] = r.value;
  });

  fetch("/validate",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({answers})
  })
  .then(r=>r.json())
  .then(res=>{
    document.getElementById("result").style.display="block";
    const sem=document.getElementById("semaphore");
    sem.className="";
    if(res.status==="GREEN"){sem.textContent="ðŸŸ¢ GREEN â€“ ACCEPTED"; sem.classList.add("green");}
    else if(res.status==="YELLOW"){sem.textContent="ðŸŸ¡ YELLOW â€“ CONDITIONAL"; sem.classList.add("yellow");}
    else{sem.textContent="ðŸ”´ RED â€“ NOT ACCEPTED"; sem.classList.add("red");}
    document.getElementById("recommendations").innerHTML = res.recommendations.join("<br>");
  });
}
</script>

</body>
</html>

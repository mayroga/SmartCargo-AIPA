<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SmartCargo ADVISORY BY MAY ROGA LLC</title>
    <style>
        :root { --navy: #0a192f; --gold: #c5a059; --red: #d32f2f; --blue-btn: #3b6695; --green: #2fa866; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: #000; font-family: 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; color: #fff; }

        /* Contenedor Principal Adaptable */
        .app-container { width: 100vw; min-height: 100vh; background: var(--navy); padding: 20px; display: flex; flex-direction: column; }
        
        /* Header y Branding */
        .header { text-align: center; margin-bottom: 20px; border-bottom: 1px solid rgba(197, 160, 89, 0.3); padding-bottom: 15px; }
        .header h1 { font-size: 28px; margin: 0; color: #fff; text-transform: uppercase; }
        .header h1 span { color: var(--gold); }
        .header p { color: var(--gold); font-weight: bold; font-size: 14px; margin: 5px 0; }

        /* Escudo Legal Grande */
        .legal-shield { background: var(--red); border: 2px solid #fff; border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .legal-shield p { margin: 0; font-size: 11px; font-weight: 800; text-transform: uppercase; line-height: 1.4; text-align: center; }

        /* Panel Blanco de Controles */
        .control-panel { background: #fff; border-radius: 20px; padding: 20px; color: #333; flex-grow: 1; }
        .label { font-size: 14px; font-weight: bold; color: var(--navy); margin-bottom: 8px; display: block; }

        /* Grid de Roles y Precios */
        .grid-options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .opt-btn { background: #f0f2f5; border: 2px solid #ddd; padding: 15px 10px; border-radius: 10px; font-size: 12px; font-weight: bold; text-align: center; cursor: pointer; transition: 0.3s; }
        .opt-btn.active { background: var(--blue-btn); color: #fff; border-color: var(--navy); }

        /* Inputs de Texto */
        input[type="text"] { width: 100%; padding: 15px; border-radius: 10px; border: 2px solid #ddd; font-size: 16px; margin-bottom: 15px; outline: none; }
        input[type="text"]:focus { border-color: var(--blue-btn); }

        /* Secciones del mainApp */
        #mainApp { display: none; margin-top: 10px; border-top: 2px dashed #ccc; padding-top: 20px; }
        
        /* Cajas de Fotos Grandes */
        .photo-area { display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px; }
        .photo-card { width: 100%; height: 250px; background: #e9ecef; border: 3px dashed var(--gold); border-radius: 15px; display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden; }
        .photo-card img { width: 100%; height: 100%; object-fit: contain; z-index: 2; }
        .photo-card span { position: absolute; font-weight: bold; color: var(--navy); font-size: 14px; text-align: center; padding: 10px; }

        /* Botones de Acci√≥n Final */
        .btn-action { width: 100%; padding: 18px; border-radius: 12px; border: none; font-size: 18px; font-weight: bold; cursor: pointer; text-transform: uppercase; margin-bottom: 10px; }
        .btn-validate { background: var(--blue-btn); color: #fff; box-shadow: 0 4px 10px rgba(59, 102, 149, 0.4); }
        .btn-solution { background: var(--green); color: #fff; box-shadow: 0 4px 10px rgba(47, 168, 102, 0.4); }

        /* √Årea de Respuesta */
        #responseBox { display: none; margin-top: 20px; background: #f8f9fa; border-left: 5px solid var(--gold); padding: 15px; border-radius: 8px; }
        .res-content { font-size: 15px; line-height: 1.6; color: #000; font-weight: 500; white-space: pre-wrap; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <h1>SmartCargo <span>ADVISORY</span></h1>
        <p>Technical Consulting by MAY ROGA LLC</p>
    </div>

    <div class="legal-shield">
        <p>‚ö†Ô∏è LEGAL SHIELD: PRIVATE ADVISORS ONLY. NOT IATA, CBP, TSA, OR DOT. WE ADVISE TO PREVENT FINES; WE DO NOT CERTIFY OR INSPECT CARGO. CONSULT OFFICIAL REGS FOR DG.</p>
    </div>

    <div class="control-panel">
        <label class="label">Step 1: Select Role & Service</label>
        <div class="grid-options">
            <div class="opt-btn" onclick="selRole('Shipper', this)">Shipper</div>
            <div class="opt-btn" onclick="selRole('Forwarder', this)">Forwarder</div>
            <div class="opt-btn" onclick="selRole('Trucker', this)">Trucker</div>
            <div class="opt-btn" onclick="selRole('Critical35', this)">Critical Advisory ($35)</div>
        </div>

        <input type="text" id="awb" placeholder="Enter AWB or Reference Number">
        <button id="vBtn" class="btn-action btn-validate" onclick="unlock()">VALIDATE & ACCESS</button>

        <div id="mainApp">
            <label class="label">Step 2: Evidence (Large Photos)</label>
            <div class="photo-area">
                <div class="photo-card" onclick="document.getElementById('f1').click()">
                    <img id="p1" style="display:none;">
                    <span>üì∏ CAPTURE DOCUMENT (AWB/DGD)</span>
                    <input type="file" id="f1" accept="image/*" hidden onchange="handlePic(event, 'p1')">
                </div>
                <div class="photo-card" onclick="document.getElementById('f2').click()">
                    <img id="p2" style="display:none;">
                    <span>üì∏ CAPTURE CARGO / PALLET</span>
                    <input type="file" id="f2" accept="image/*" hidden onchange="handlePic(event, 'p2')">
                </div>
            </div>

            <label class="label">Step 3: Cargo Evidence / Findings</label>
            <input type="text" id="findings" placeholder="Describe the situation here...">
            
            <button id="sBtn" class="btn-action btn-solution" onclick="generate()">GET TECHNICAL SOLUTION</button>

            <div id="responseBox">
                <label class="label">ADVISORY RESPONSE:</label>
                <div id="resTxt" class="res-content"></div>
                <div style="margin-top:15px; display:flex; gap:10px;">
                    <button class="opt-btn" style="flex:1" onclick="window.print()">PDF</button>
                    <button class="opt-btn" style="flex:1; background:#25d366; color:#fff;" onclick="shareWS()">WhatsApp</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let role = "";
    function selRole(r, e) {
        role = r;
        document.querySelectorAll('.opt-btn').forEach(b => b.classList.remove('active'));
        e.classList.add('active');
    }

    function unlock() {
        if(!role || !document.getElementById('awb').value) return alert("Select Role and enter AWB");
        document.getElementById('mainApp').style.display = "block";
        document.getElementById('vBtn').style.display = "none";
    }

    function handlePic(ev, id) {
        const reader = new FileReader();
        reader.onload = e => {
            const img = document.getElementById(id);
            img.src = e.target.result;
            img.style.display = "block";
            img.nextElementSibling.style.display = "none";
        };
        reader.readAsDataURL(ev.target.files[0]);
    }

    async function generate() {
        const btn = document.getElementById('sBtn');
        const box = document.getElementById('responseBox');
        const txt = document.getElementById('resTxt');
        
        btn.disabled = true;
        btn.innerText = "ANALYZING... PLEASE WAIT";
        box.style.display = "block";
        txt.innerText = "Processing high-resolution data and legal standards...";

        const fd = new FormData();
        fd.append('prompt', document.getElementById('findings').value);
        fd.append('role', role);
        fd.append('awb', document.getElementById('awb').value);

        try {
            const r = await fetch('https://smartcargo-backend.onrender.com/advisory', { method: 'POST', body: fd });
            const j = await r.json();
            txt.innerText = j.data;
        } catch (e) {
            txt.innerText = "Error connecting to server. Please check your internet.";
        } finally {
            btn.disabled = false;
            btn.innerText = "GET TECHNICAL SOLUTION";
        }
    }

    function shareWS() {
        const t = document.getElementById('resTxt').innerText;
        window.open(`https://wa.me/?text=${encodeURIComponent(t)}`);
    }
</script>
</body>
</html>

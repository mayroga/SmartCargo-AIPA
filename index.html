<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMARTCARGO-AIPA by MAY ROGA LLC</title>
    <style>
        :root {
            --green: #28a745;
            --yellow: #ffc107;
            --red: #dc3545;
            --black: #050505;
            --white: #ffffff;
            --gray: #1a1a1a;
            --gold: #c5a059;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--black);
            color: var(--white);
        }

        h1 {
            text-align: center;
            color: var(--gold);
        }

        .section {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 10px;
            background: var(--gray);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            margin: 6px 0;
            border-radius: 6px;
            border: 1px solid #444;
            background: #222;
            color: #fff;
        }

        label {
            font-weight: bold;
            margin-top: 8px;
            display: block;
        }

        button {
            padding: 15px;
            margin-top: 10px;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-submit { background: var(--gold); color: var(--black); width: 100%; }

        .semaforo {
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 10px;
        }

        .docs-list {
            margin-top: 10px;
            border: 1px solid #444;
            padding: 10px;
            border-radius: 6px;
            max-height: 250px;
            overflow-y: auto;
            background: #111;
        }

    </style>
</head>
<body>
    <h1>SMARTCARGO-AIPA by MAY ROGA LLC</h1>

    <!-- Pantalla 1: Identificaci√≥n de carga -->
    <div class="section" id="pantalla-carga">
        <h2>1Ô∏è‚É£ Identificaci√≥n de Carga</h2>
        <label for="airline">Aerol√≠nea</label>
        <select id="airline">
            <option value="Avianca Cargo" selected>Avianca Cargo</option>
        </select>

        <label for="mawb">MAWB</label>
        <input type="text" id="mawb" placeholder="N√∫mero MAWB" required>

        <label for="hawb">HAWB (si aplica)</label>
        <input type="text" id="hawb" placeholder="N√∫mero HAWB">

        <label for="origin">Origen</label>
        <input type="text" id="origin" placeholder="Ciudad / Aeropuerto">

        <label for="destination">Destino</label>
        <input type="text" id="destination" placeholder="Ciudad / Aeropuerto">

        <label for="cargoType">Tipo de Carga</label>
        <select id="cargoType">
            <option value="GEN">General (GEN)</option>
            <option value="DG">Peligrosa (DG)</option>
            <option value="PER">Perishable (PER)</option>
            <option value="HUM">Humanitaria (HUM)</option>
            <option value="AVI">Animal Vivo (AVI)</option>
            <option value="VAL">Valor (VAL)</option>
        </select>

        <label for="flightDate">Fecha de Vuelo</label>
        <input type="date" id="flightDate">
    </div>

    <!-- Pantalla 2: Documentos -->
    <div class="section" id="pantalla-documentos">
        <h2>2Ô∏è‚É£ Documentos</h2>
        <input type="file" id="invoice" placeholder="Commercial Invoice">
        <input type="file" id="packingList" placeholder="Packing List">
        <input type="file" id="sli" placeholder="Shipper‚Äôs Letter of Instruction">
        <input type="file" id="awbDoc" placeholder="AWB / eAWB">
        <input type="file" id="certificates" placeholder="Certificados (DG / PER / HUM)">
        <input type="file" id="msds" placeholder="MSDS si aplica">
        <input type="file" id="permits" placeholder="Permisos pa√≠s destino">
    </div>

    <!-- Pantalla 3: Resultado operativo -->
    <div class="section" id="pantalla-resultados">
        <h2>3Ô∏è‚É£ Resultado Operativo</h2>
        <button class="btn-submit" onclick="submitCarga()">Validar Carga</button>
        <div class="semaforo" id="semaforo"></div>
        <div class="docs-list" id="docsStatus"></div>
    </div>

    <script>
        async function submitCarga() {
            const cargaData = {
                airline: document.getElementById('airline').value,
                mawb: document.getElementById('mawb').value,
                hawb: document.getElementById('hawb').value,
                origin: document.getElementById('origin').value,
                destination: document.getElementById('destination').value,
                cargoType: document.getElementById('cargoType').value,
                flightDate: document.getElementById('flightDate').value
            };

            const formData = new FormData();
            for (let key in cargaData) formData.append(key, cargaData[key]);

            // Archivos
            ['invoice','packingList','sli','awbDoc','certificates','msds','permits'].forEach(id => {
                const file = document.getElementById(id).files[0];
                if (file) formData.append(id, file);
            });

            const res = await fetch('/validate', { method: 'POST', body: formData });
            const data = await res.json();

            // Sem√°foro operativo
            const sem = document.getElementById('semaforo');
            sem.innerText = data.status;
            sem.style.color = (data.status === "üî¥ NO ACEPTABLE") ? 'red' : (data.status === "üü° ACEPTABLE CON RIESGO") ? 'yellow' : 'green';

            // Documentos
            const docDiv = document.getElementById('docsStatus');
            docDiv.innerHTML = data.documents.map(d => `${d.name}: ${d.status} ${d.comment || ''}`).join('<br>');
        }
    </script>
</body>
</html>
